using System;

namespace projekat2
{
    class Program
    {
         public struct Polje
        {
            public bool poseceno;
            public bool mina;
            public bool zastavica;
            public bool upitnik;
        }

        public static bool ponavljaj = true;

        static void Naslov()
        {
            Console.WriteLine(@"  __  __ _                                                   
 |  \/  (_)_ __   ___  _____      _____  ___ _ __   ___ _ __ 
 | |\/| | | '_ \ / _ \/ __\ \ /\ / / _ \/ _ \ '_ \ / _ \ '__|
 | |  | | | | | |  __/\__ \\ V  V /  __/  __/ |_) |  __/ |   
 |_|  |_|_|_| |_|\___||___/ \_/\_/ \___|\___| .__/ \___|_|   
                                            |_|              ");
        }

        public static string Uputstva = @" Zastavica [F]
 Upitnik [U]
 Otvaranje polja [Enter]";

        static void Pomoc()
        {
            Console.Clear();
            Console.WriteLine(@"Dobrodosli u Minesweeper.
Ako ste korisnik Windows-a, velike su sanse da vec imate ovu igru na svom racunaru. 
Ovaj vodic ce vam pomoci da završite svoju prvu igru.
Pravila igre su jednostavna, broj na polju pokazuje broj mina pored njega, a vas cilj je da otvorite sva polja bez mina.
");
            Console.ForegroundColor = ConsoleColor.DarkRed;
            Console.Write("!");
            Console.ResetColor();
            Console.WriteLine(" - zastavica. Zastavicu stavite na mesto na kome ste sigurni da ima mina. [Z]");
            Console.ForegroundColor = ConsoleColor.DarkYellow;
            Console.Write("?");
            Console.ResetColor();
            Console.WriteLine(" - upitnik. Upitnik stavite na mesto na kome mislite da ima mina. [U]");
            Console.WriteLine();
            Console.WriteLine("[Esc] - povratak na meni iz igre.");
            Console.WriteLine();
            Console.WriteLine("Pritisnite [Esc] da biste se vratili u meni...");
            while (Console.ReadKey(true).Key != ConsoleKey.Escape)//program ceka da se pritisne escape
            { }
        }

        static void Izlaz_Iz_Programa()
        {
            Console.Clear();
            Console.WriteLine("Program uspešno napusten...");
            Environment.Exit(0);
        }

        static void Meni_Start()
        {
            string[] opcije = { "Igraj igru...", "Uputstva...", "Izlaz..." };
            int odabranaOpcija = Pokreni(opcije);

            //pocetne dimenzije(x i y osa) i broj mina
            int x_dimenzije = 0;
            int mine = 0;
            int y_dimenzije = 0;

            switch (odabranaOpcija)
            {
                case 0:
                    Console.Clear();
                    string[] opcije1 = { "Tabela 9 x 9", "Tabela 16 x 16", "Tabela 16 x 36", "Prilagodite...", "Nazad..." };
                    odabranaOpcija = Pokreni(opcije1);
                    switch (odabranaOpcija)
                    {
                        case 0:
                            x_dimenzije = y_dimenzije = 9;
                            mine = 10;
                            Console.Clear();
                            break;
                        case 1:
                            x_dimenzije = y_dimenzije = 16;
                            mine = 40;
                            Console.Clear();
                            break;
                        case 2:
                            x_dimenzije = 16;
                            y_dimenzije = 36;
                            mine = 99;
                            Console.Clear();
                            break;
                        case 3:
                            Console.Clear();
                            Naslov();
                            Console.WriteLine();
                            Console.WriteLine("Unesite dimenzije: ");
                            Console.Write("Visina [max 40]: ");
                            bool dobar_ulaz = false;
                            while (!dobar_ulaz)
                            {
                                dobar_ulaz = true;

                                while (!int.TryParse(Console.ReadLine(), out x_dimenzije))
                                {
                                    dobar_ulaz = false;
                                    Console.Write("Greska pri unosu. Duzina: ");
                                }
                                if (x_dimenzije > 40)
                                {
                                    dobar_ulaz = false;
                                    Console.Write("Smiri x koordinate. Duzina: ");
                                }
                            }
                            Console.Write("Duzina [max 40]: ");
                            dobar_ulaz = false;
                            while (!dobar_ulaz)
                            {
                                dobar_ulaz = true;

                                while (!int.TryParse(Console.ReadLine(), out y_dimenzije))
                                {
                                    dobar_ulaz = false;
                                    Console.Write("Greska pri unosu. Duzina: ");
                                }
                                if (y_dimenzije > 40)
                                {
                                    dobar_ulaz = false;
                                    Console.Write("Smiri y koordinate. Duzina: ");
                                }
                            }
                            Console.Write("Broj mina [max 250]: ");
                            dobar_ulaz = false;
                            while (!dobar_ulaz)
                            {
                                dobar_ulaz = true;
                                while (!int.TryParse(Console.ReadLine(), out mine))
                                {
                                    dobar_ulaz = false;
                                    Console.Write("Greska pri unosu. Broj mina: ");
                                }
                                if (mine >= x_dimenzije * y_dimenzije || mine > 250)
                                {
                                    dobar_ulaz = false;
                                    Console.Write("Greska pri unosu. Broj mina: ");
                                }
                                if (mine == 281105)
                                {
                                    Console.WriteLine(@"
...,,..*..*((####%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%####((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((########%%%%%%#########((((((((((///////////////**,,...              
      ...*..*,.*/(((####%%%%%%%%%%%%%%%%%%%%%%%%%%%%###(((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((#####################(((((((((((////////*//////**..               
      ..,,..,..*(((((####%%%%%%%%%%%%%%%%%%%%%%%%%%####((((((((((((((((((((((((((((((((((((((((((((((((((((((/////////////////((((((((((#######%%##########(((((((((((/////********/****,.              
       .*,....,/(((((######%%%%%%%%%%%%%%%%%%%%%%%###(((((((((((((((((((((((((((((((((((((((((((((((((((////(/////////////////////(((((((###########(######(((((((((((((((///***********,,....          
        *,...,,/(((((#######%%%%%%%%%%%%%%%%%%%%%####((((((((((((((((((((((((((((((((((/((//////////((((/////////////////////////////((((###########((#####((((((((((((((((((//***///****,.             
.       .,..,,*/(((((########%%%%%%%%%%%%%%%%%%%#####((((((((((((((((((((((((((((((((((//////////////////////////////////////////////((((###########(((#####(((((((((((((((((((/*************,,,,..,,.. 
/        .... ,/(((###########%%%%%%%%%%%%%%%%%####(((((((((((((((((((((((((((((((//((///////////////////////////////////////////////((((((##########(((#####(((((((((((((((((((///**********,**,,,,****
              .*((((###########%%%%%%%%%%%%%%%###(((((((((((((((((((((///////////////////////////////////////////////////////////////((((((((##########(((#######((((((((((((((((////*******/***,.......
              .,/(((############%%%%%%%%%%%%%%##(((((((((((((((///////////////////////////////////////////////////////////////////////((((((((######%###((##########((#((((((((((((((((((/////******,...
.            .,,*((((############%%%%%%%%%%%%###(((((((((((((/////////////////////////////////////////////////////////////////////////(((((((((####%%%%%##(###########((((####((((((((((((////*********,
,            ,,,**/((((((#########%%%%%%%%%%%%##(((((((((((((///////////////////////////////////////////////////////////////((((((((((((((((((#######%%%%%%######################(((((((/////***,,......
.             ,,***//((((((#######%%%%%%%%%%%%##((((((((((((((///////////////////////////////////////////*****//////((((((##########################%%%%%%%%%%#####################(((((///*******,,....
.             ,,*****/((((((#######%%%%%%%%%%%##(((((((((((/((((((//////////////////////////////************/////((((#######%%%%%%%%%%%%%#%##########%%%%&&%%%%%%%#################(((((((//*******,,,..
.             ,,,,,,*///((((((######%%%%%%%%%%%#((((((((((((((((((((((//////////////////////////**********///(((((########%%%%%%%%%###############%%%%%%&&&&&&&&%%%%%%%%%%%%%%####((///((//////****,,...
.            .,,,,,,*////(((((#######%%%%%%%%%%##((((((((((((((((((#########(((((((//////////////***/****///(((((#######%%#####((((/////////((####%%%%%%%&&&&&&&&&&&%%%%%%%%%%%##((//**,/(/////****,,,,.
.            ...,,,*///////((((#######%%%%%%%%%##((((((((########%%%%%%%%#######((((((///////////****//////((((((((#######(((/////////////////(((((##%%%&&&&&&&&&&&&&&&&&%%%%%%#((((/*****//*/*****,,,,,
,...       .,,,,,,**////////((((######%%%%%%%%%%#((##########%%%%%%%%%%%%%%#########((((//((////****,,*///////((((((((((((((/////////////////////((((#%%&&&&&&&&&&&&&&&&%%%%%%%%##((//**//,**,*,,,,,,,,,
,,,,*,,,,,,,,,,,***///////(((((((#######%%%%%%%################(######%%%%#%########(((((((////******,,,*//////////////((((/////////((((//////////((((#%%%&&&&&&&&&&&%%%%%%%%%%%%##((/*****,,,,,,,,,.,,,
,  .,,,,**********//////////(((((######%%%%%%%%########(((((((((((((((((((###########(((((/////*****,,,,**//////////((((#####%%%%#%%####(((((((//////((%%%&&&&&&&%%%%%%&%%%%%%%%%##(((//*****,,,,,,,....
..    ..,,,,**////////(((((((((((#####%%%%%%%%%####((((((((/////////((((((((((((((###((((((////****,,,,,,*****//(((########%%%%&&&&%#((#%%%%###((/////(#%%&&&&&&%%%%%&&&&&%%%%%%%###(((//***/*******,,..
.*******,**///////(((((((((((((((#####%%%%%%%%%#(((((////////////((((##################((((////****,,,,,,,,***/((#####(((#%%%%%#%%%%%#//(##%%%##((////(#%%&&&&&&%%%%%&&&&&&%%%%%%##((((((///*********,,,
.*********//////(/((((((((((((((######%%%%%%%%%#(((//////((((###%%%%%%%%%#(((((#########((////*****,,,,,,,,,,**/(#########%%%%%%%%%%%######(((((((/////(%%%&&&&%%%%%&&&&&&&%%%%%####((((((////*******,.,
.****////////*/////(((((((((((#######%%%%%%%%%%#((/////(((#####(#%%%%%%%%%%#((((########(/////*****,,,,,,,,,,,**//(((#########((((((///////////////////(#%%&&&&%%%%%&&&&&&&&%%%%%%###((((((////*.,,,**..
 ,**,,,,,,******////(((((((#######%%%%%%%%%%%%%#((((//(#####((((#%%%%%#%%%%%###########(////******,,,,,,,,,,,,,,***//////(((((((////////////////////////(#%%%%%%%%%%&&&&&&&&%%%%%%%####((((////**,,,,,..
.,,,,************///(((((#########%%%%%%%%%%%%%%(((((((###########%%%%%%%%#########((((////*/*****,,,,,,,,,....,,,,****/////////////////************/////(%%%%%%%%%%%%&&&&&%%%%%%%%%#####((/////****,,..
.**,..,,**///////(((((((((###########%%%%%%%%%%%#(((((((#((((((((((((((((((((((((((((////*********,,,,,,,,......,,,,,,,*****//*/************************/(#%%%%%%%%%%%%&&&&%%%%%%%%%%##((((/////***,,,,.
,**,,,,**********/////(((((############%%%%%%%%%#(((((((((//////////(((((((((((((((((////*********,,,,,,,,,.........,,,,,,,,,*******************,,,,,***//(#%%%%%%%%%%%&&&&&%%#######(((///////***,,,,,,
,**,,,,,,*********////(((((############%%%%%%%%%#(((((((///////////(((((((((////////////////********,,,,,,,,,,,...,,,,,,,,,,,,,,,,,,,*******,,,,,,,,,,***//(%%%%%%%%%%%%%%%&%%########((//////***,,,,,.*
***,,,,,,*********////((((((############%%%%%%%%#(((((//////******///////////////////******/*********,,,,.........,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,**/(#%%%%%%%%%%%%%%%%%%%%###((((////**,....,,,**
,*,,,,,,,,***,,****//(((((((############%%%%%%%%#((((////////*****************,****////***************,,,.....  ....,,***,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,**/#%%%%%%%%%%%%%%%###%%#(((((((/////**/*******
.******,,,,,,,****//(((((/(((((##########%%%%%%%#((((////////*************,,,,,,**////*****************,,,,...     ..,,*/***,,,,,,,,,,,,,,,,,,,,,,,,,,.,,,*/(#%%%%%%%%%%%%%%%%%#####((/((/////*********,
 *****,,,,,,,****////////((((((###########%%%%%%#(((/////////***********,,,*,****///********************,,,,...      ..,*//****,,,,,,,,,,,,,,,,,,,,,,...,,**/#%%%%%%%%%%%#%%%%%%#(###((((////*,,,,**,,. 
 **,,*******,*****//////(((((((####((######%%%%#(((///////////*****************///************************,,,....    ..,,*///***,,,,,,,,,,,,,,,,,,,......,,**(#######%%#%%%###%%####((((((//***,****,,. 
 **,,,,,***********/*/////(((((((((((#######%%%##(////////////****************////*************************,,,,,........,,*////****,,,,,,,,,,,,,,,,,.....,,**/#######################((((((//*******,,  
 ************************///((((((((((###########(//////////****************/////***********///////************,,,,,,...,**///////***,,,,,,,,,,,,,,,,,...,,,**(######%%%#############((((////***,,**.   
 *********************,*/////////((((((##########(//////////****************/////****////////////////***************,,,,*****//////****,,,,,,,,,,,,,,,,,,,,,**/####%%%%%%%%#########((((/(///*****,...  
 **********,,,,,,,,,****////((((((((((((((#######(/////////****************///////****/////////////////**************,,,,,,*****/////***,,,,,,,,,,,,,,,,,,,,,*/#####%%%%%%#%########((///*///***,.      
 *********,,,,,,,,,****//////(((((((((((((#######(////*********************////////////////////////////*************,,,,,,,,,****/////****,,,,,,,,,,,,,,,,,,,*/#%%%%%%%####(((#####(((///****,,,..      
 *******,,,,,,,,,,*****//////////((((((((((######(/////******************//////////////////////////////************,,,,,,,,,,,,,**/////****,,,,,,,,,,,,,,,,,,**###%%%%%###########(##(((/**,,,,..       
 *******,,,,,,,,,,,******//***//////((((((((#####(/////******************///////////////////////////////////******,,,,,,,,,,,,,,,***////****,,,,,,,,,,,,,,,,***###%#%%#######(((#####((//*,*,*,.        
 ******,,,    ..,,,,,********//////////(((((####((//////****************/////////////////////////////////////****,,,,,,,,,,,,,,,,,***////****,,,,,,,,,,,,,,,,**(####################(((//*,,,*..   ..   
 ******,.      .,...,,,****..*///////////((((((((((//******************///////////////////////////////////////*/**,,,,,,,,.....,,,,**/////***,,,,,,,,,,,,,,***/##################(((((/////**,,.....    
 ******.       .,.. .,,***,,,***/////////((((((((((//*/****************//////////////////////////////////////*****,,,,,,.....  ..,,,**////****,,,,,,,,,,,,,***//(###############(((((/***/**,......     
 ****,        .... . ,*****,*.,,*****////(((((((((((*******************/////////////////////////////////////*******,,,,,......   ..,,**/////**,,,,,,,,,,,,***((((//**///(((###(((((//,.                 
 ***,             ...,,*******..*******///////////((/******************/////////*******////////////////////*///////*****,,,,...  ...,**/////**,,,,,,,,,,,,**/(#(//(/((//****/(((((*,.                   
 **,                .,*****,*,,.********//////****////*******/******///////////********//////////////////////////////////***,,......,***////***,,,,,,,,,,,**(####(///*/**/(((/*,*,.                     
 *.                  .,******/,.**********//***,,//////,,****//**/*////////////****//////////////(((((((((/////**//****//(((//**,,...,**////***,,,,,,,,,,,**(#####((/(//(/*.....,,,                     
                      ,,******,.**********,.. .,**////((*,********//*//////////****/////(((//////***,,*******,,**********////(((/**,.,***///***,,,,,,,,,,,*((((###((**/,,,,..,..,,,                     
                      .,*****,. ****/////*. ..,****////((/.,********///////////***///(((((//////***,,,,******,,,,*******/##((#%#((/*,,***///***,,,,,,,,,,,((#(((#((/*,**,.. .....                       
.                      ,**///*  ****///(((    .*****///(((/,,,*******//////////***/(((((##//**//*****************/(%%%%%%%%%%%%%##(/*,***///***,,,,,,,,,,/(###//((//**,,                                
(                      .,/////  *////((/*/.    *****/////(((,.,********/////////*//(((###%%%%%%%#(((((#####%%%%%%%%%%%%%%%%%%%%%##((/****////***,,,,,,,,*#####((/((/*,.,                               .
(                       ,*/*,*, /////(((((.    ,,***////(((((*.,*******////////////((###%%%%%%%%%%######################%%%%%%#####(//*/*/////**,,,,,,.,(######((((/...                                (
(                       .,**.** /////(((((,     ,****////(((((/,,********//////////((######%%%%%##########################%%%%######(/////////**,.,,...*#######(((//*.                               .((
(                        ,**,,/.//////((((*       .**///((((((((,,,******/////////((((######%%%############################%%%######(//////////*,.,,..,/#######(/,.                                  /((
(                        .**,***//////((((*          .***///(((((,.,,****///////////((#################((((((###############%#######(//////////*,,,,,.,/(#####(**,,.                                /(((
(                         ,**.*///////((((/      ,,,,.  .**//****,..,,,****////////(((#######%########((((((((###(((###############((/**///////*,.....,/#(/(//*****,                               /((##
(                         .**.,///////((((/       .,. ...,********....,,,**/////////(((###############(((((((((((((((##############((/***//////*,.....,,  ,****,,,,.                              /((##(
(                          ,*,,///////(((((       ,,,,,,,.,*******,...,,,,*///////////((#############((((((((((((((((((############((/***//////*,.......,,,******,.                              /((###(
(                          .**.,*/////(((((,.     .,,,.,,*..*******.....,,,*///////////((###########((((((((((((((((((((##########((/*,**//////*,..,,,,,********.                               /(((##((
(                           ,*,,//////(((((,,,.    .,,,,..*********,.....,,**///////////((((((#####(((((((((((((((((((((###(######(/*,,**//////*,,,,,,,,********.                              *((((((((
(                           .****//////((((*..,,,,,,,,,.,..,********. ....,,*////////////(#####((((((((((((((((((##########(((((#((/*,,**//////*,,,,,,,*******,.                              *(((((((((
(                           .**,,//////((((/*******,,,,,*,**********,.....,,*/////////////(((((((((((((((((#################((((#(/**,,**//////*,,,,,,,*******.                   ...,.      *((##((((((
/                            ,*,,//////(((((((((((((((#(((((((((((((/....,..,*////////**////(((((((###########%%%%%%%%%%%%#(((((((/**,,****///*,,,,,,,,*******.                  .,,..,     *((##(((((((");
                                    Environment.Exit(1);
                                }
                            }
                            Console.Clear();
                            break;

                        case 4:
                            Meni_Start();
                            break;
                    }
                    break;

                case 1:
                    Pomoc();
                    Meni_Start();
                    break;

                case 2:
                    Izlaz_Iz_Programa();
                    break;
                    
            }
            
            Polje[,] tabelica = new Polje[x_dimenzije, y_dimenzije];

            for (int i = 0; i < tabelica.GetLength(0); i++)
            {
                for (int j = 0; j < tabelica.GetLength(1); j++)
                {
                    tabelica[i, j].poseceno = tabelica[i, j].mina = false;
                }
            }

            tabelica = Upisi_minice(tabelica, mine, x_dimenzije, y_dimenzije);


            int[] odabrano_polje = { 0, 0 };
            Ispis(tabelica, odabrano_polje[0], odabrano_polje[1], mine);
            ponavljaj = true;

            while (ponavljaj)
            {
                odabrano_polje = BiranjePolja(tabelica, odabrano_polje[0], odabrano_polje[1], mine);
                if (tabelica[odabrano_polje[0], odabrano_polje[1]].mina)
                {
                    Console.Clear();
                    Ispis_Tabelice_Poraz(tabelica);
                }
                else
                {
                    Otvori_Polje(tabelica, odabrano_polje[0], odabrano_polje[1]);
                }
                if (ponavljaj == false)
                {
                    Meni_Start();
                }
            }
        }

        static int Pokreni(string[] Options)
        {
            int indeks = 0;

            ConsoleKey pritisnuto_dugme;
            do
            {
                Console.Clear();
                Displej(Options, indeks);

                ConsoleKeyInfo keyInfo = Console.ReadKey(true);

                if (keyInfo.Key == ConsoleKey.DownArrow)
                {
                    indeks++;
                }
                if (indeks == Options.Length)
                {
                    indeks = 0;
                }
                else if (keyInfo.Key == ConsoleKey.UpArrow)
                {
                    indeks--;
                }
                if (indeks == -1)
                {
                    indeks = Options.Length - 1;
                }
                pritisnuto_dugme = keyInfo.Key;
            } while (pritisnuto_dugme != ConsoleKey.Enter); //program ceka da se pritisne enter
            return indeks;
        }

        static void Displej(string[] Options, int indeks)
        {
            Naslov();
            Console.WriteLine();
            for (int i = 0; i < Options.Length; i++)
            {
                if (i == indeks)
                {
                    Console.ForegroundColor = ConsoleColor.DarkGray;
                    Console.BackgroundColor = ConsoleColor.Black;
                    Console.Write("-> ");
                    string trenutna_opcija = Options[i];
                    Console.WriteLine(trenutna_opcija);
                }
                else
                {
                    Console.ForegroundColor = ConsoleColor.White;
                    Console.BackgroundColor = ConsoleColor.Black;
                    string trenutna_opcija = Options[i];
                    Console.WriteLine("  " + trenutna_opcija);
                }
                Console.ResetColor();
            }
        }

        static void Surenje()
        {
            Console.WriteLine(@"  ___                              _                  _ 
 |_ _|__ _ _ __ __ _    __ _  ___ | |_ _____   ____ _| |
  | |/ _` | '__/ _` |  / _` |/ _ \| __/ _ \ \ / / _` | |
  | | (_| | | | (_| | | (_| | (_) | || (_) \ V / (_| |_|
 |___\__, |_|  \__,_|  \__, |\___/ \__\___/ \_/ \__,_(_)
     |___/             |___/                            
                                         
                                                  
Pritinsite [Enter] da nastavite...");
            ponavljaj = false;
        }

        static void Main(string[] args)
        {
            Console.WriteLine("Hello");
        }
    }
}
